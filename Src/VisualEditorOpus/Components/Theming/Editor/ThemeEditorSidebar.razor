@* Theme editor sidebar with scrollable sections *@
@implements IDisposable

@using VisualEditorOpus.Services.Theming
@using VisualEditorOpus.Components.Theming.Editor.Sections

<div class="theme-editor-sidebar">
    <div class="sidebar-header">
        <span class="sidebar-title">Theme Settings</span>
    </div>

    <div class="sidebar-content">
        @if (ThemeState.CurrentTheme is null)
        {
            <div class="sidebar-empty">
                <i class="bi bi-palette"></i>
                <span>No theme loaded</span>
            </div>
        }
        else
        {
            <ThemePresetSection />
            <ColorsSection />
            <TypographySection />
            <BordersSection />
        }
    </div>
</div>

@code {
    [Inject] private IThemeEditorStateService ThemeState { get; set; } = default!;

    protected override void OnInitialized()
    {
        ThemeState.OnThemeChanged += HandleThemeChanged;
    }

    private void HandleThemeChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        ThemeState.OnThemeChanged -= HandleThemeChanged;
    }
}
