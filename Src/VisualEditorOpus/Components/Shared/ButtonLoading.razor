@* Button with integrated loading state *@
@using VisualEditorOpus.Models

<button class="btn @ButtonClass @(IsLoading ? "btn-loading" : "") @CssClass"
        disabled="@(IsLoading || Disabled)"
        type="@Type"
        @onclick="HandleClick">
    @if (IsLoading)
    {
        <span class="btn-text" style="opacity: 0;">@ChildContent</span>
        <LoadingSpinner Size="SpinnerSize.Small"
                        Color="@SpinnerColorValue"
                        CssClass="btn-spinner" />
    }
    else
    {
        @ChildContent
    }
</button>

@code {
    /// <summary>
    /// Button content
    /// </summary>
    [Parameter] public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Button style variant
    /// </summary>
    [Parameter] public ButtonVariant Variant { get; set; } = ButtonVariant.Primary;

    /// <summary>
    /// Whether the button is in loading state
    /// </summary>
    [Parameter] public bool IsLoading { get; set; }

    /// <summary>
    /// Whether the button is disabled
    /// </summary>
    [Parameter] public bool Disabled { get; set; }

    /// <summary>
    /// Click event handler
    /// </summary>
    [Parameter] public EventCallback OnClick { get; set; }

    /// <summary>
    /// Button type attribute
    /// </summary>
    [Parameter] public string Type { get; set; } = "button";

    /// <summary>
    /// Additional CSS classes
    /// </summary>
    [Parameter] public string? CssClass { get; set; }

    private string ButtonClass => Variant switch
    {
        ButtonVariant.Outline => "btn-outline",
        ButtonVariant.Ghost => "btn-ghost",
        ButtonVariant.Success => "btn-success",
        ButtonVariant.Danger => "btn-danger",
        _ => "btn-primary"
    };

    private SpinnerColor SpinnerColorValue => Variant switch
    {
        ButtonVariant.Outline => SpinnerColor.Primary,
        ButtonVariant.Ghost => SpinnerColor.Primary,
        _ => SpinnerColor.White
    };

    private async Task HandleClick()
    {
        if (!IsLoading && !Disabled)
        {
            await OnClick.InvokeAsync();
        }
    }
}
