@namespace VisualEditorOpus.Components.Preview

<div class="json-status-bar">
    <div class="status-left">
        <span class="status-item @(IsValid ? "status-valid" : "status-invalid")">
            <i class="bi bi-@(IsValid ? "check-circle-fill" : "x-circle-fill")"></i>
            @(IsValid ? "Valid JSON" : "Invalid JSON")
        </span>
        <span class="status-item">
            <i class="bi bi-clock"></i>
            Last modified: @GetRelativeTime(LastModified)
        </span>
    </div>
    <div class="status-right">
        <span class="cursor-position">Ln @CursorPosition.Line, Col @CursorPosition.Column</span>
        <span class="status-item">@Encoding</span>
        <span class="status-item">@FileType</span>
    </div>
</div>

@code {
    [Parameter] public bool IsValid { get; set; }
    [Parameter] public DateTime LastModified { get; set; }
    [Parameter] public (int Line, int Column) CursorPosition { get; set; }
    [Parameter] public string Encoding { get; set; } = "UTF-8";
    [Parameter] public string FileType { get; set; } = "JSON";

    private string GetRelativeTime(DateTime time)
    {
        var diff = DateTime.Now - time;

        if (diff.TotalSeconds < 60) return "Just now";
        if (diff.TotalMinutes < 60) return $"{(int)diff.TotalMinutes} min ago";
        if (diff.TotalHours < 24) return $"{(int)diff.TotalHours} hour(s) ago";
        return time.ToString("MMM d, yyyy");
    }
}
